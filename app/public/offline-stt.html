<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›¢ç·šèªéŸ³è½‰æ–‡å­— - Offline Speech to Text</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #fff;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
        }

        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            margin-bottom: 24px;
        }

        /* Status Badge */
        .status-badge {
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge.warning {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-badge.success {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .status-badge.error {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .status-dot.warning {
            background: #f59e0b;
            animation: pulse 1.5s infinite;
        }

        .status-dot.success {
            background: #22c55e;
        }

        .status-dot.error {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .status-content {
            flex: 1;
        }

        .status-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .status-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Section Title */
        .section-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 12px;
            font-weight: 600;
        }

        /* Model Selection */
        .model-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .model-btn {
            padding: 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: white;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .model-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: rgba(99, 102, 241, 0.5);
        }

        .model-btn.selected {
            background: rgba(99, 102, 241, 0.3);
            border-color: #6366f1;
        }

        .model-btn .model-name {
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 4px;
        }

        .model-btn .model-desc {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 6px;
        }

        .model-btn .model-tag {
            font-size: 11px;
            color: #4ade80;
        }

        .model-btn.selected .model-tag {
            color: #a5b4fc;
        }

        /* Select Dropdown */
        .select-wrapper {
            margin-bottom: 24px;
        }

        .select-wrapper select {
            width: 100%;
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 14px;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
        }

        .select-wrapper select:focus {
            outline: none;
            border-color: #6366f1;
        }

        .select-wrapper select option {
            background: #1a1a2e;
            color: white;
        }

        .select-wrapper select optgroup {
            background: #16213e;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
        }

        .hint-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 8px;
        }

        .hint-text.warning {
            color: #fbbf24;
        }

        /* Loading Progress */
        .loading-section {
            margin-bottom: 24px;
            display: none;
        }

        .loading-section.show {
            display: block;
        }

        .loading-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .loading-header span {
            font-size: 14px;
        }

        .loading-percent {
            color: #8b5cf6;
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 1.5s infinite;
        }

        @keyframes shine {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }

        .loading-status {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 8px;
        }

        /* Upload Zone */
        .upload-section {
            display: none;
        }

        .upload-section.show {
            display: block;
        }

        .upload-zone {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 16px;
        }

        .upload-zone:hover {
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(99, 102, 241, 0.1);
        }

        .upload-zone.dragover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.2);
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .upload-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .upload-desc {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 16px;
        }

        .upload-btn {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
        }

        /* Limitations Info */
        .limitations-info {
            padding: 12px 16px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            font-size: 13px;
        }

        .limitations-info h4 {
            font-size: 13px;
            color: #a5b4fc;
            margin-bottom: 8px;
        }

        .limitations-info ul {
            list-style: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        .limitations-info li {
            margin-bottom: 4px;
        }

        .limitations-info li::before {
            content: "â€¢";
            color: #a5b4fc;
            margin-right: 8px;
        }

        /* File Warning */
        .file-warning {
            margin-top: 16px;
            padding: 16px;
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 12px;
            display: none;
        }

        .file-warning.show {
            display: block;
        }

        .warning-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .warning-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .warning-content {
            flex: 1;
        }

        .warning-title {
            font-weight: 600;
            color: #fbbf24;
            margin-bottom: 4px;
        }

        .warning-message {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
        }

        .warning-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* File Info */
        .file-info {
            margin-top: 16px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        .file-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .file-icon {
            font-size: 32px;
        }

        .file-details {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-meta {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        .file-remove {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .file-remove:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .file-duration {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 12px;
        }

        .file-audio {
            width: 100%;
            height: 40px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        /* Buttons */
        button {
            padding: 14px 28px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            width: 100%;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-success {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(34, 197, 94, 0.4);
        }

        .btn-warning {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .btn-warning:hover:not(:disabled) {
            background: rgba(245, 158, 11, 0.3);
        }

        .btn-sm {
            padding: 10px 16px;
            font-size: 13px;
        }

        /* Transcription Progress */
        .transcription-progress {
            margin-top: 16px;
            padding: 16px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            display: none;
        }

        .transcription-progress.show {
            display: block;
        }

        .progress-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .waveform-bars {
            display: flex;
            gap: 3px;
            align-items: center;
            height: 24px;
        }

        .waveform-bar {
            width: 3px;
            background: #8b5cf6;
            border-radius: 2px;
            animation: waveform 0.5s ease-in-out infinite alternate;
        }

        @keyframes waveform {
            from { height: 8px; }
            to { height: 24px; }
        }

        .progress-info {
            flex: 1;
        }

        .progress-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .progress-title span:first-child {
            font-weight: 600;
            color: #a5b4fc;
        }

        .progress-title .percent {
            color: #8b5cf6;
            font-weight: 600;
        }

        .progress-status {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .progress-eta {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.4);
            margin-top: 8px;
        }

        /* Results Section */
        .results-section {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 24px;
            padding: 24px;
            max-width: 600px;
            width: 100%;
            margin-bottom: 20px;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .results-title {
            font-size: 18px;
            font-weight: 700;
            color: #4ade80;
        }

        .results-actions {
            display: flex;
            gap: 8px;
        }

        .results-actions button {
            padding: 8px 12px;
            font-size: 13px;
        }

        .transcript-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 16px;
            min-height: 120px;
            max-height: 300px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.9);
            white-space: pre-wrap;
            margin-bottom: 12px;
        }

        .results-stats {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            flex-wrap: wrap;
        }

        /* Upgrade CTA */
        .upgrade-cta {
            margin-top: 16px;
            padding: 16px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
        }

        .cta-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .cta-icon {
            font-size: 24px;
        }

        .cta-content {
            flex: 1;
        }

        .cta-title {
            font-weight: 600;
            color: #c4b5fd;
            margin-bottom: 4px;
        }

        .cta-desc {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 12px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 24px;
            max-width: 420px;
            width: 100%;
            padding: 32px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .modal-header .icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .modal-header h3 {
            font-size: 22px;
            margin-bottom: 8px;
        }

        .modal-header p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
        }

        .feature-list {
            margin-bottom: 24px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .feature-item .check {
            color: #4ade80;
            font-size: 18px;
        }

        .feature-item span {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .modal-trial {
            text-align: center;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 16px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-buttons button {
            flex: 1;
        }

        /* Footer */
        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.4);
            font-size: 12px;
            max-width: 600px;
        }

        .footer p {
            margin-bottom: 4px;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 24px;
            }

            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .results-actions {
                width: 100%;
                justify-content: flex-start;
            }

            .modal-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ™ï¸ é›¢ç·šèªéŸ³è½‰æ–‡å­—</h1>
        <p class="subtitle">Offline Speech to Text - 100% æœ¬åœ°è™•ç†ï¼Œè³‡æ–™ä¸é›¢é–‹æ‚¨çš„è£ç½®</p>

        <!-- Model Status -->
        <div class="status-badge warning" id="modelStatus">
            <span class="status-dot warning"></span>
            <div class="status-content">
                <div class="status-title">æ¨¡å‹å°šæœªè¼‰å…¥</div>
                <div class="status-text">è«‹å…ˆè¼‰å…¥ Whisper æ¨¡å‹ä»¥é–‹å§‹ä½¿ç”¨</div>
            </div>
        </div>

        <!-- Model Selection -->
        <div class="section-title">é¸æ“‡æ¨¡å‹</div>
        <div class="model-grid">
            <button class="model-btn" id="btn-tiny" onclick="loadModel('Xenova/whisper-tiny')">
                <div class="model-name">Whisper Tiny</div>
                <div class="model-desc">~75MBãƒ»é€Ÿåº¦å¿«ãƒ»æº–ç¢ºåº¦ä¸­ç­‰</div>
                <div class="model-tag">âœ“ æ¨è–¦ç”¨æ–¼å¿«é€Ÿæ¸¬è©¦</div>
            </button>
            <button class="model-btn" id="btn-base" onclick="loadModel('Xenova/whisper-base')">
                <div class="model-name">Whisper Base</div>
                <div class="model-desc">~150MBãƒ»é€Ÿåº¦ä¸­ç­‰ãƒ»æº–ç¢ºåº¦è¼ƒé«˜</div>
                <div class="model-tag">âœ“ å¹³è¡¡é¸æ“‡</div>
            </button>
        </div>

        <!-- Language Selection -->
        <div class="section-title">èªè¨€è¨­å®š</div>
        <div class="select-wrapper">
            <select id="languageSelect">
                <optgroup label="ğŸŒ è‡ªå‹•">
                    <option value="auto">è‡ªå‹•åµæ¸¬ (Auto Detect)</option>
                </optgroup>
                <optgroup label="ğŸŒ æ±äºèªè¨€">
                    <option value="zh">ä¸­æ–‡ Chinese (æ™®é€šè©±/åœ‹èªï¼Œå«ç°¡ç¹é«”)</option>
                    <option value="yue">å»£æ±è©±/ç²µèª Cantonese (é¦™æ¸¯ã€å»£æ±)</option>
                    <option value="ja">æ—¥æ–‡ Japanese</option>
                    <option value="ko">éŸ“æ–‡ Korean</option>
                </optgroup>
                <optgroup label="ğŸŒ æ±å—äºèªè¨€">
                    <option value="th">æ³°æ–‡ Thai</option>
                    <option value="vi">è¶Šå—æ–‡ Vietnamese</option>
                    <option value="id">å°å°¼æ–‡ Indonesian</option>
                    <option value="ms">é¦¬ä¾†æ–‡ Malay</option>
                    <option value="tl">è²å¾‹è³“æ–‡ Tagalog</option>
                    <option value="my">ç·¬ç”¸æ–‡ Myanmar</option>
                    <option value="km">é«˜æ£‰æ–‡ Khmer</option>
                    <option value="lo">å¯®æ–‡ Lao</option>
                </optgroup>
                <optgroup label="ğŸŒ æ­æ´²èªè¨€">
                    <option value="en">è‹±æ–‡ English</option>
                    <option value="es">è¥¿ç­ç‰™æ–‡ Spanish</option>
                    <option value="fr">æ³•æ–‡ French</option>
                    <option value="de">å¾·æ–‡ German</option>
                    <option value="it">ç¾©å¤§åˆ©æ–‡ Italian</option>
                    <option value="pt">è‘¡è„ç‰™æ–‡ Portuguese</option>
                    <option value="nl">è·è˜­æ–‡ Dutch</option>
                    <option value="pl">æ³¢è˜­æ–‡ Polish</option>
                    <option value="ru">ä¿„æ–‡ Russian</option>
                    <option value="uk">çƒå…‹è˜­æ–‡ Ukrainian</option>
                    <option value="cs">æ·å…‹æ–‡ Czech</option>
                    <option value="el">å¸Œè‡˜æ–‡ Greek</option>
                    <option value="sv">ç‘å…¸æ–‡ Swedish</option>
                    <option value="da">ä¸¹éº¥æ–‡ Danish</option>
                    <option value="fi">èŠ¬è˜­æ–‡ Finnish</option>
                    <option value="no">æŒªå¨æ–‡ Norwegian</option>
                    <option value="tr">åœŸè€³å…¶æ–‡ Turkish</option>
                    <option value="ro">ç¾…é¦¬å°¼äºæ–‡ Romanian</option>
                    <option value="hu">åŒˆç‰™åˆ©æ–‡ Hungarian</option>
                </optgroup>
                <optgroup label="ğŸŒ ä¸­æ±/å—äºèªè¨€">
                    <option value="ar">é˜¿æ‹‰ä¼¯æ–‡ Arabic</option>
                    <option value="he">å¸Œä¼¯ä¾†æ–‡ Hebrew</option>
                    <option value="fa">æ³¢æ–¯æ–‡ Persian</option>
                    <option value="hi">å°åœ°æ–‡ Hindi</option>
                    <option value="bn">å­ŸåŠ æ‹‰æ–‡ Bengali</option>
                    <option value="ta">å¦ç±³çˆ¾æ–‡ Tamil</option>
                    <option value="te">æ³°ç›§å›ºæ–‡ Telugu</option>
                    <option value="ur">çƒçˆ¾éƒ½æ–‡ Urdu</option>
                    <option value="ne">å°¼æ³Šçˆ¾æ–‡ Nepali</option>
                </optgroup>
                <optgroup label="ğŸŒ éæ´²èªè¨€">
                    <option value="sw">æ–¯ç“¦å¸Œé‡Œæ–‡ Swahili</option>
                    <option value="af">å—éè·è˜­æ–‡ Afrikaans</option>
                </optgroup>
            </select>
            <p class="hint-text">ğŸ’¡ é¸æ“‡ã€Œè‡ªå‹•åµæ¸¬ã€è®“ Whisper è‡ªå‹•è­˜åˆ¥èªè¨€ï¼Œæˆ–æŒ‡å®šèªè¨€ä»¥æé«˜æº–ç¢ºåº¦</p>
            <p class="hint-text warning">âš ï¸ ä¸­æ–‡æœƒè‡ªå‹•åˆ¤æ–·ç°¡é«”/ç¹é«”è¼¸å‡ºï¼ˆç„¡æ³•å¼·åˆ¶æŒ‡å®šï¼‰ï½œå»£æ±è©±/ç²µèªåœ¨ tiny/base æ¨¡å‹æ”¯æ´æœ‰é™ï¼Œå»ºè­°ä½¿ç”¨é›²ç«¯ç‰ˆ</p>
        </div>

        <!-- Loading Progress -->
        <div class="loading-section" id="loadingSection">
            <div class="loading-header">
                <span>è¼‰å…¥æ¨¡å‹ä¸­...</span>
                <span class="loading-percent" id="loadingPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="loadingBar" style="width: 0%"></div>
            </div>
            <p class="loading-status" id="loadingStatus">æ­£åœ¨ä¸‹è¼‰æ¨¡å‹æª”æ¡ˆ...</p>
        </div>

        <!-- Upload Section -->
        <div class="upload-section" id="uploadSection">
            <div class="upload-zone" id="dropZone">
                <input type="file" id="audioInput" accept="audio/*,video/*" style="display: none;">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-title">æ‹–æ”¾éŸ³è¨Š/å½±ç‰‡æª”æ¡ˆåˆ°é€™è£¡</div>
                <div class="upload-desc">æ”¯æ´ MP3, WAV, M4A, MP4, WebM ç­‰æ ¼å¼</div>
                <div class="upload-btn">é¸æ“‡æª”æ¡ˆ</div>
            </div>

            <div class="limitations-info">
                <h4>ğŸ“‹ æœ¬åœ°æ¨¡å‹é™åˆ¶</h4>
                <ul>
                    <li>å»ºè­°æª”æ¡ˆå¤§å°ï¼š<strong>100MB ä»¥å…§</strong></li>
                    <li>å»ºè­°éŸ³è¨Šé•·åº¦ï¼š<strong>30 åˆ†é˜ä»¥å…§</strong></li>
                    <li>è™•ç†æ™‚é–“å–æ±ºæ–¼æ‚¨çš„è£ç½®æ•ˆèƒ½</li>
                </ul>
            </div>
        </div>

        <!-- File Warning -->
        <div class="file-warning" id="fileWarning">
            <div class="warning-header">
                <span class="warning-icon">âš ï¸</span>
                <div class="warning-content">
                    <div class="warning-title" id="warningTitle">æª”æ¡ˆè¼ƒå¤§</div>
                    <div class="warning-message" id="warningMessage">æ­¤æª”æ¡ˆå¯èƒ½éœ€è¦è¼ƒé•·è™•ç†æ™‚é–“ï¼Œå»ºè­°ä½¿ç”¨é›²ç«¯ç‰ˆæœ¬ç²å¾—æ›´å¿«é€Ÿçš„è™•ç†ã€‚</div>
                    <div class="warning-buttons">
                        <button class="btn-warning btn-sm" onclick="proceedAnyway()">ä»ç„¶ä½¿ç”¨æœ¬åœ°è™•ç†</button>
                        <button class="btn-primary btn-sm" onclick="showCloudCTA()">ä½¿ç”¨é›²ç«¯ç‰ˆæœ¬ â†’</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Info -->
        <div class="file-info" id="fileInfo">
            <div class="file-header">
                <span class="file-icon">ğŸµ</span>
                <div class="file-details">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-meta" id="fileMeta"></div>
                </div>
                <button class="file-remove" onclick="clearFile()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="file-duration" id="audioDurationInfo"></div>
            <audio id="audioPreview" controls class="file-audio"></audio>
            <button class="btn-primary" id="transcribeBtn" onclick="startTranscription()">
                é–‹å§‹è½‰éŒ„ ğŸš€
            </button>
        </div>

        <!-- Transcription Progress -->
        <div class="transcription-progress" id="transcriptionProgress">
            <div class="progress-header">
                <div class="waveform-bars">
                    <div class="waveform-bar" style="animation-delay: 0s"></div>
                    <div class="waveform-bar" style="animation-delay: 0.1s"></div>
                    <div class="waveform-bar" style="animation-delay: 0.2s"></div>
                    <div class="waveform-bar" style="animation-delay: 0.3s"></div>
                    <div class="waveform-bar" style="animation-delay: 0.4s"></div>
                </div>
                <div class="progress-info">
                    <div class="progress-title">
                        <span>æ­£åœ¨è½‰éŒ„ä¸­...</span>
                        <span class="percent" id="transcriptionPercent">0%</span>
                    </div>
                    <div class="progress-status" id="transcriptionStatus">è™•ç†éŸ³è¨Šè³‡æ–™</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="transcriptionBar" style="width: 0%"></div>
            </div>
            <p class="progress-eta" id="transcriptionETA"></p>
        </div>
    </div>

    <!-- Results Section -->
    <div class="results-section" id="resultsSection">
        <div class="results-header">
            <h2 class="results-title">ğŸ“ è½‰éŒ„çµæœ</h2>
            <div class="results-actions">
                <button class="btn-secondary btn-sm" onclick="copyText()">ğŸ“‹ è¤‡è£½</button>
                <button class="btn-secondary btn-sm" onclick="downloadTxt()">ğŸ“„ TXT</button>
                <button class="btn-secondary btn-sm" onclick="downloadSrt()">ğŸ¬ SRT</button>
            </div>
        </div>
        <div class="transcript-box" id="transcriptText"></div>
        <div class="results-stats">
            <span id="statWords"></span>
            <span id="statTime"></span>
            <span id="statDuration"></span>
        </div>

        <!-- Upgrade CTA -->
        <div class="upgrade-cta">
            <div class="cta-header">
                <span class="cta-icon">ğŸ’¡</span>
                <div class="cta-content">
                    <div class="cta-title">éœ€è¦æ›´é«˜æº–ç¢ºåº¦ï¼Ÿ</div>
                    <div class="cta-desc">æœ¬åœ°æ¨¡å‹é©åˆå¿«é€Ÿè½‰éŒ„ï¼Œä½†é‡åˆ°å£éŸ³ã€å¤šäººå°è©±ã€å°ˆæ¥­è¡“èªæ™‚å¯èƒ½ä¸å¤ ç²¾æº–ã€‚å‡ç´šåˆ°é›²ç«¯ç‰ˆæœ¬å¯ç²å¾— Whisper Large V3 çš„è¶…é«˜æº–ç¢ºåº¦ã€‚</div>
                    <button class="btn-primary btn-sm" onclick="showCloudCTA()">å‡ç´š Transcript AI â†’</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cloud CTA Modal -->
    <div class="modal-overlay" id="cloudModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="icon">â˜ï¸</div>
                <h3>Transcript AI é›²ç«¯ç‰ˆ</h3>
                <p>å°ˆç‚ºé•·éŸ³è¨Šå’Œé«˜æº–ç¢ºåº¦éœ€æ±‚è¨­è¨ˆ</p>
            </div>
            <div class="feature-list">
                <div class="feature-item">
                    <span class="check">âœ“</span>
                    <span>Whisper Large V3 è¶…é«˜æº–ç¢ºåº¦</span>
                </div>
                <div class="feature-item">
                    <span class="check">âœ“</span>
                    <span>æ”¯æ´æœ€é•· 4 å°æ™‚éŸ³è¨Š</span>
                </div>
                <div class="feature-item">
                    <span class="check">âœ“</span>
                    <span>è‡ªå‹•æ®µè½æ•´ç† & èªªè©±è€…åˆ†é›¢</span>
                </div>
                <div class="feature-item">
                    <span class="check">âœ“</span>
                    <span>AI æ‘˜è¦ & å¤šèªè¨€ç¿»è­¯</span>
                </div>
                <div class="feature-item">
                    <span class="check">âœ“</span>
                    <span>è™•ç†é€Ÿåº¦å¿« 10 å€ä»¥ä¸Š</span>
                </div>
            </div>
            <p class="modal-trial">ğŸ å…è²»è©¦ç”¨ 10 åˆ†é˜éŸ³è¨Š</p>
            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeCloudModal()">ç¨å¾Œå†èªª</button>
                <button class="btn-success">å…è²»è©¦ç”¨ â†’</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>ğŸ”’ æ‰€æœ‰è™•ç†éƒ½åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬åœ°å®Œæˆï¼ŒéŸ³è¨Šè³‡æ–™ä¸æœƒä¸Šå‚³åˆ°ä»»ä½•ä¼ºæœå™¨</p>
        <p>Powered by Transformers.js & Whisper</p>
    </div>

    <script type="module">
        import { pipeline, env } from 'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.0.0';
        
        env.allowLocalModels = false;
        
        // Global state
        let transcriber = null;
        let isModelLoaded = false;
        let currentModelName = '';
        let audioBlob = null;
        let audioDuration = 0;
        let transcriptData = null;
        let pendingFile = null;

        // Constants
        const MAX_FILE_SIZE_MB = 100;
        const MAX_DURATION_MINUTES = 30;
        const WARNING_FILE_SIZE_MB = 50;
        const WARNING_DURATION_MINUTES = 15;

        // Make functions global
        window.loadModel = loadModel;
        window.handleFileSelect = handleFileSelect;
        window.handleDrop = handleDrop;
        window.clearFile = clearFile;
        window.startTranscription = startTranscription;
        window.copyText = copyText;
        window.downloadTxt = downloadTxt;
        window.downloadSrt = downloadSrt;
        window.proceedAnyway = proceedAnyway;
        window.showCloudCTA = showCloudCTA;
        window.closeCloudModal = closeCloudModal;

        // Setup upload zone
        const dropZone = document.getElementById('dropZone');
        const audioInput = document.getElementById('audioInput');

        dropZone.addEventListener('click', () => audioInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) checkAndProcessFile(file);
        });
        audioInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) checkAndProcessFile(file);
        });

        async function loadModel(modelName) {
            if (isModelLoaded && currentModelName === modelName) return;

            const loadingSection = document.getElementById('loadingSection');
            const uploadSection = document.getElementById('uploadSection');
            const modelStatus = document.getElementById('modelStatus');
            const loadingBar = document.getElementById('loadingBar');
            const loadingPercent = document.getElementById('loadingPercent');
            const loadingStatus = document.getElementById('loadingStatus');

            // Update button states
            document.getElementById('btn-tiny').classList.remove('selected');
            document.getElementById('btn-base').classList.remove('selected');
            const btnId = modelName.includes('tiny') ? 'btn-tiny' : 'btn-base';
            document.getElementById(btnId).classList.add('selected');

            loadingSection.classList.add('show');
            uploadSection.classList.remove('show');

            try {
                transcriber = await pipeline(
                    'automatic-speech-recognition',
                    modelName,
                    {
                        progress_callback: (progress) => {
                            if (progress.status === 'downloading') {
                                const percent = Math.round((progress.loaded / progress.total) * 100);
                                loadingBar.style.width = `${percent}%`;
                                loadingPercent.textContent = `${percent}%`;
                                loadingStatus.textContent = `æ­£åœ¨ä¸‹è¼‰: ${progress.file}`;
                            } else if (progress.status === 'loading') {
                                loadingStatus.textContent = 'æ­£åœ¨è¼‰å…¥æ¨¡å‹...';
                            } else if (progress.status === 'ready') {
                                loadingBar.style.width = '100%';
                                loadingPercent.textContent = '100%';
                            }
                        }
                    }
                );

                isModelLoaded = true;
                currentModelName = modelName;

                loadingSection.classList.remove('show');
                uploadSection.classList.add('show');
                
                const modelDisplayName = modelName.includes('tiny') ? 'Whisper Tiny' : 'Whisper Base';
                modelStatus.className = 'status-badge success';
                modelStatus.innerHTML = `
                    <span class="status-dot success"></span>
                    <div class="status-content">
                        <div class="status-title">æ¨¡å‹å·²å°±ç·’: ${modelDisplayName}</div>
                        <div class="status-text">å¯ä»¥é–‹å§‹ä¸Šå‚³æª”æ¡ˆé€²è¡Œè½‰éŒ„</div>
                    </div>
                `;

            } catch (error) {
                console.error('Model loading error:', error);
                loadingSection.classList.remove('show');
                modelStatus.className = 'status-badge error';
                modelStatus.innerHTML = `
                    <span class="status-dot error"></span>
                    <div class="status-content">
                        <div class="status-title">è¼‰å…¥å¤±æ•—</div>
                        <div class="status-text">${error.message}</div>
                    </div>
                `;
            }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) checkAndProcessFile(file);
        }

        function handleDrop(event) {
            event.preventDefault();
            const file = event.dataTransfer.files[0];
            if (file) checkAndProcessFile(file);
        }

        async function checkAndProcessFile(file) {
            const fileSizeMB = file.size / 1024 / 1024;
            const url = URL.createObjectURL(file);
            const audio = new Audio();
            
            audio.onloadedmetadata = () => {
                audioDuration = audio.duration;
                const durationMinutes = audioDuration / 60;
                URL.revokeObjectURL(url);
                
                let warnings = [];
                
                if (fileSizeMB > MAX_FILE_SIZE_MB) {
                    warnings.push(`æª”æ¡ˆå¤§å° (${fileSizeMB.toFixed(1)}MB) è¶…éå»ºè­°ä¸Šé™ ${MAX_FILE_SIZE_MB}MB`);
                } else if (fileSizeMB > WARNING_FILE_SIZE_MB) {
                    warnings.push(`æª”æ¡ˆè¼ƒå¤§ (${fileSizeMB.toFixed(1)}MB)ï¼Œè™•ç†å¯èƒ½éœ€è¦è¼ƒé•·æ™‚é–“`);
                }
                
                if (durationMinutes > MAX_DURATION_MINUTES) {
                    warnings.push(`éŸ³è¨Šé•·åº¦ (${durationMinutes.toFixed(1)} åˆ†é˜) è¶…éå»ºè­°ä¸Šé™ ${MAX_DURATION_MINUTES} åˆ†é˜`);
                } else if (durationMinutes > WARNING_DURATION_MINUTES) {
                    warnings.push(`éŸ³è¨Šè¼ƒé•· (${durationMinutes.toFixed(1)} åˆ†é˜)ï¼Œè™•ç†å¯èƒ½éœ€è¦è¼ƒé•·æ™‚é–“`);
                }
                
                if (warnings.length > 0) {
                    pendingFile = file;
                    showFileWarning(warnings, fileSizeMB > MAX_FILE_SIZE_MB || durationMinutes > MAX_DURATION_MINUTES);
                } else {
                    processFile(file);
                }
            };
            
            audio.onerror = () => {
                URL.revokeObjectURL(url);
                if (fileSizeMB > WARNING_FILE_SIZE_MB) {
                    pendingFile = file;
                    showFileWarning([`æª”æ¡ˆè¼ƒå¤§ (${fileSizeMB.toFixed(1)}MB)`], fileSizeMB > MAX_FILE_SIZE_MB);
                } else {
                    processFile(file);
                }
            };
            
            audio.src = url;
        }

        function showFileWarning(warnings, isError) {
            const warningDiv = document.getElementById('fileWarning');
            const warningTitle = document.getElementById('warningTitle');
            const warningMessage = document.getElementById('warningMessage');
            
            warningTitle.textContent = isError ? 'æª”æ¡ˆè¶…å‡ºå»ºè­°é™åˆ¶' : 'æé†’';
            warningMessage.innerHTML = warnings.join('<br>') + '<br><br>å»ºè­°ä½¿ç”¨é›²ç«¯ç‰ˆæœ¬ç²å¾—æ›´å¥½çš„è™•ç†æ•ˆæœå’Œé€Ÿåº¦ã€‚';
            
            warningDiv.classList.add('show');
            document.getElementById('fileInfo').classList.remove('show');
        }

        function proceedAnyway() {
            if (pendingFile) {
                document.getElementById('fileWarning').classList.remove('show');
                processFile(pendingFile);
                pendingFile = null;
            }
        }

        function showCloudCTA() {
            document.getElementById('cloudModal').classList.add('show');
        }

        function closeCloudModal() {
            document.getElementById('cloudModal').classList.remove('show');
        }

        function processFile(file) {
            audioBlob = file;
            
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileMeta = document.getElementById('fileMeta');
            const audioPreview = document.getElementById('audioPreview');
            const audioDurationInfo = document.getElementById('audioDurationInfo');

            fileName.textContent = file.name;
            fileMeta.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB â€¢ ${file.type || 'æœªçŸ¥æ ¼å¼'}`;
            
            if (audioDuration > 0) {
                const mins = Math.floor(audioDuration / 60);
                const secs = Math.floor(audioDuration % 60);
                const estimatedTime = Math.ceil(audioDuration / 60 * 0.5);
                audioDurationInfo.textContent = `â±ï¸ éŸ³è¨Šé•·åº¦: ${mins} åˆ† ${secs} ç§’ â€¢ é ä¼°è™•ç†æ™‚é–“: ${estimatedTime}-${estimatedTime * 2} åˆ†é˜`;
            }
            
            const url = URL.createObjectURL(file);
            audioPreview.src = url;
            
            fileInfo.classList.add('show');
            document.getElementById('fileWarning').classList.remove('show');
            document.getElementById('resultsSection').classList.remove('show');
        }

        function clearFile() {
            audioBlob = null;
            audioDuration = 0;
            pendingFile = null;
            document.getElementById('fileInfo').classList.remove('show');
            document.getElementById('fileWarning').classList.remove('show');
            document.getElementById('audioInput').value = '';
        }

        async function startTranscription() {
            if (!audioBlob || !transcriber) {
                alert('è«‹å…ˆè¼‰å…¥æ¨¡å‹ä¸¦é¸æ“‡æª”æ¡ˆ');
                return;
            }

            const transcribeBtn = document.getElementById('transcribeBtn');
            const transcriptionProgress = document.getElementById('transcriptionProgress');
            const resultsSection = document.getElementById('resultsSection');
            const transcriptionStatus = document.getElementById('transcriptionStatus');
            const transcriptionPercent = document.getElementById('transcriptionPercent');
            const transcriptionBar = document.getElementById('transcriptionBar');
            const transcriptionETA = document.getElementById('transcriptionETA');

            transcribeBtn.disabled = true;
            transcribeBtn.textContent = 'è™•ç†ä¸­...';
            transcriptionProgress.classList.add('show');
            resultsSection.classList.remove('show');

            transcriptionPercent.textContent = '0%';
            transcriptionBar.style.width = '0%';

            try {
                transcriptionStatus.textContent = 'è®€å–éŸ³è¨Šæª”æ¡ˆ...';
                transcriptionPercent.textContent = '5%';
                transcriptionBar.style.width = '5%';
                
                const arrayBuffer = await audioBlob.arrayBuffer();
                
                transcriptionStatus.textContent = 'è§£ç¢¼éŸ³è¨Š...';
                transcriptionPercent.textContent = '10%';
                transcriptionBar.style.width = '10%';
                
                const audioContext = new AudioContext({ sampleRate: 16000 });
                const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                const audioData = audioBuffer.getChannelData(0);
                const totalDuration = audioBuffer.duration;
                
                transcriptionStatus.textContent = 'æ­£åœ¨è½‰éŒ„...';
                transcriptionPercent.textContent = '15%';
                transcriptionBar.style.width = '15%';
                
                const estimatedSeconds = Math.ceil(totalDuration * 0.5);
                transcriptionETA.textContent = `é ä¼°å‰©é¤˜æ™‚é–“: ${Math.ceil(estimatedSeconds / 60)} åˆ†é˜`;
                
                const startTime = performance.now();
                const selectedLang = document.getElementById('languageSelect').value;
                
                const transcribeOptions = {
                    chunk_length_s: 30,
                    stride_length_s: 5,
                    return_timestamps: true,
                    task: 'transcribe',
                    callback_function: (progress) => {
                        if (progress.chunks && progress.chunks.length > 0) {
                            const lastChunk = progress.chunks[progress.chunks.length - 1];
                            if (lastChunk.timestamp && lastChunk.timestamp[1]) {
                                const processedTime = lastChunk.timestamp[1];
                                const percent = Math.min(95, 15 + Math.round((processedTime / totalDuration) * 80));
                                transcriptionPercent.textContent = `${percent}%`;
                                transcriptionBar.style.width = `${percent}%`;
                                
                                const elapsed = (performance.now() - startTime) / 1000;
                                const rate = processedTime / elapsed;
                                const remaining = (totalDuration - processedTime) / rate;
                                if (remaining > 0 && isFinite(remaining)) {
                                    transcriptionETA.textContent = `é ä¼°å‰©é¤˜æ™‚é–“: ${Math.ceil(remaining)} ç§’`;
                                }
                            }
                        }
                    }
                };
                
                if (selectedLang !== 'auto') {
                    transcribeOptions.language = selectedLang;
                }
                
                const result = await transcriber(audioData, transcribeOptions);
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(1);

                transcriptionPercent.textContent = '100%';
                transcriptionBar.style.width = '100%';
                transcriptionStatus.textContent = 'å®Œæˆï¼';
                transcriptionETA.textContent = '';

                transcriptData = result;

                document.getElementById('transcriptText').textContent = result.text.trim();
                
                const charCount = result.text.trim().length;
                document.getElementById('statWords').textContent = `${charCount} å­—`;
                document.getElementById('statTime').textContent = `è™•ç†æ™‚é–“: ${processingTime} ç§’`;
                document.getElementById('statDuration').textContent = `éŸ³è¨Šé•·åº¦: ${Math.floor(totalDuration / 60)}:${Math.floor(totalDuration % 60).toString().padStart(2, '0')}`;

                setTimeout(() => {
                    transcriptionProgress.classList.remove('show');
                    resultsSection.classList.add('show');
                }, 500);

            } catch (error) {
                console.error('Transcription error:', error);
                transcriptionStatus.textContent = 'è½‰éŒ„å¤±æ•—';
                transcriptionETA.textContent = error.message;
                
                setTimeout(() => {
                    alert('è½‰éŒ„å¤±æ•—: ' + error.message);
                    transcriptionProgress.classList.remove('show');
                }, 1000);
            } finally {
                transcribeBtn.disabled = false;
                transcribeBtn.textContent = 'é–‹å§‹è½‰éŒ„ ğŸš€';
            }
        }

        function copyText() {
            const text = document.getElementById('transcriptText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            });
        }

        function downloadTxt() {
            const text = document.getElementById('transcriptText').textContent;
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            downloadBlob(blob, 'transcript.txt');
        }

        function downloadSrt() {
            if (!transcriptData || !transcriptData.chunks) {
                const text = document.getElementById('transcriptText').textContent;
                const srt = `1\n00:00:00,000 --> 00:00:30,000\n${text}\n`;
                const blob = new Blob([srt], { type: 'text/plain;charset=utf-8' });
                downloadBlob(blob, 'transcript.srt');
                return;
            }

            let srt = '';
            transcriptData.chunks.forEach((chunk, index) => {
                const start = formatSrtTime(chunk.timestamp[0]);
                const end = formatSrtTime(chunk.timestamp[1]);
                srt += `${index + 1}\n${start} --> ${end}\n${chunk.text.trim()}\n\n`;
            });

            const blob = new Blob([srt], { type: 'text/plain;charset=utf-8' });
            downloadBlob(blob, 'transcript.srt');
        }

        function formatSrtTime(seconds) {
            if (!seconds && seconds !== 0) return '00:00:00,000';
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = Math.floor(seconds % 60);
            const ms = Math.round((seconds % 1) * 1000);
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')},${ms.toString().padStart(3, '0')}`;
        }

        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
